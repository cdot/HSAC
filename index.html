<!DOCTYPE html>
<html>
  <!-- BUILD_DATE Fri 11 Jan 11:56:52 GMT 2019 -->
  <head>
    <meta charset="UTF-8">
    <meta name="cache-control" content="public">
    <meta name="expires" content="Mon, 2 Apr 2018 09:00:00 GMT">
    
    <link rel="shortcut icon" href="images/favicon.png?version=1546871839" type="png" />
    <link rel="icon" href="images/favicon.png?version=1546871839" type="png" />
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-barstyle" content="black-translucent">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png?version=1546871839">

    <!-- for Chrome on Android, multi-resolution icon of 196x196 -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <title>HSAC Sheds</title>

    <link rel="icon" href="images/favicon.png?version=1546871839" />

    <!--babel src="libs/polyfill.min.js"></script-->
    
    <!-- from //cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1 -->
    <script src="libs/jquery.min.js?version=1544605889"></script>

    <!-- from //cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1 -->
    <script src="libs/jquery-ui/jquery-ui.min.js?version=1544605889"></script>
    <!-- from //code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css -->
    <link href="libs/jquery-ui/jquery-ui.min.css?version=1544605889" rel="stylesheet">
    
    <link href="libs/jquery-icon-font/jquery-ui.icon-font.min.css?version=1545127002" rel="stylesheet">

    <!-- From https://use.fontawesome.com/releases/v5.6.3 -->
    <link href="libs/fontawesome/css/solid.min.css" rel="stylesheet">
    <link href="libs/fontawesome/css/fontawesome.min.css" rel="stylesheet">

    <!-- from https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.0 -->
    <script src="libs/jquery-validate/jquery.validate.js?version=1545127002"></script>
    <script src="libs/jquery-validate/additional-methods.js?version=1545127002"></script>
    
    <!-- from //cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.0 -->
    <script src="libs/js.cookie.min.js?version=1544605889"></script>
   
    <!-- from https://github.com/evanplaice/jquery-csv/tree/master/src -->
    <script src="libs/jquery.csv.min.js?version=1544605889"></script>

    <!-- From https://github.com/craftpip/jquery-confirm -->
    <script src="libs/jquery-confirm/jquery-confirm.min.js?version=1546719988"></script>
    <link href="libs/jquery-confirm/jquery-confirm.min.css?version=1546719988" rel="stylesheet">

    <!-- from https://github.com/Mottie/tablesorter -->
    <script src="libs/tablesorter/js/jquery.tablesorter.min.js?version=1544605889"></script>
    <script src="libs/tablesorter/js/jquery.tablesorter.widgets.min.js?version=1544605889"></script>
    <link href="libs/tablesorter/css/theme.jui.min.css?version=1544605889" rel="stylesheet">

    <script src="libs/davclient.min.js?version=1548017411"></script>

    <script src="js/AbstractStore.js?version=1547979451"></script>
    <script src="js/WebDAVStore.js?version=1548017550"></script>
    <script src="js/Nitrox.js?version=1549195405"></script>
    <script src="js/with-info.js?version=1547205387"></script>
    <link   href="css/with-info.css?version=1547205387" rel="stylesheet">
    <script src="js/in-place.js?version=1547205387"></script>
    <link   href="css/in-place.css?version=1547205387" rel="stylesheet">
    <script src="js/Entries.js?version=1549195376"></script>
    <script src="js/Compressor.js?version=1549195896"></script>
    <script src="js/Loans.js?version=1548017552"></script>
    <script src="js/Inventory.js?version=1548017552"></script>
    <script src="js/Roles.js?version=1548017552"></script>
    <script src="js/Config.js?version=1549195822"></script>
    <script src="js/Sheds.js?version=1549197672"></script>
    <link href="css/Sheds.css?version=1547213373" rel="stylesheet">

  </head>
  <body>
    <div id="loading">
      Loading...
    </div>
    <div id="loaded" class="hidden">
      <div id="main_tabs">
        <div id="settings_block">
          <span id="settings" class="fas fa-sliders-h"></span>
        </div>
        <ul style="margin-right:1.2em">
          <li><a href="#static">Static Compressor</a></li>
          <li><a href="#portable">Portable Compressor</a></li>
          <li><a href="#loans">Loans</a></li>
          <li><a href="#inventory">Inventory</a></li>
          <li><a href="#nitrox">Nitrox</a></li>
        </ul>

        <div id="static" class="crowded_tab">
          <form id="static_form" class="validated_form">
            <div>
              Last run by <span class="cr_operator">?</span> on
              <span class="cr_time">?</span>, runtime was <span class="cr_runtime">0</span> <span class="cr_last_run">minutes <span class='fas fa-cog'></span></span><br />
              <span data-with-info="#infoFilterEfficiency">Filter lifetime remaining is <span class="cr_flr">?</span> hours</span>
            </div>
            <div>
              Enter details of your run below:
            </div>
            <table class="form_table zebra" id="compressor_table">
              <tr>
                <th class="input_label">
                  <span data-with-info="#infoOperator">
                    Operator
                  </span>
                </th>
                <td colspan="2" class="widest">
                  <select name="operator" class="operator" data-msg="Must be a trained operator" required>
                    <option></option>
                  </select>
                </td>
              </tr>
              <tr>
                <th class="input_label">
                  <span data-with-info="#infoTemperature">
                    Temperature
                  </span>
                </th>
                <td class="widest">
                  <input type="number" class="integer" name="temperature" data-msg="Must be between 4&deg;C and 40&deg;C" required min="4" max="40" value="20" data-sampler='{"config":"static_filter_sensor_id","max_age":300000,"disabled":"#from_sensor"}'> &deg;C <span style="display:none" id="from_sensor">(detected)</span>
                </td>
              </tr>
              <!--
                  <tr>
                    <th class="input_label">
                      <span data-with-info="#infoHumidity">
                        Relative Humidity
                      </span>
                    </th>
                    <td class="widest">
                      <input data-msg="Must be between 0 and 100" name="humidity" type="number" class="integer" min="0" max="100"> %
                    </td>
                  </tr>
              -->
              <tr>
                <th class="input_label">
                  <span data-with-info="#infoRuntime">
                    Runtime
                  </span>
                </th>
                <td class="widest">
                  <input type="number" class="floating_point" step="0.01" name="runtime" data-msg="Must be greater than the last recorded runtime" min="0" required>
                  minutes
                </td>
              </tr>
            </table>
            <div style="float:right">
              <label for="static_filters_changed">Filters changed</label>
              <input data-with-info="#infoFilters" type="checkbox" id="static_filters_changed" name="filters_changed">
            </div>
          </form>
          <button name="add_record">Touch here to record this run</button>
        </div>
        
        <div id="portable" class="crowded_tab">
          <form id="portable_form" class="validated_form">
            <div>
              Last run by <span class="cr_operator">?</span> on
              <span class="cr_time">?</span>, runtime was <span class="cr_runtime">0</span> <span class="cr_last_run">minutes <span class='fas fa-cog'></span></span><br />
              <span data-with-info="#infoFilterEfficiency">Filter lifetime remaining is <span class="cr_flr">?</span> hours at 20&deg;C</span>
            </div>
            <div>
              Enter details of your run below:
            </div>
            <table class="form_table zebra" id="compressor_table">
              <tr>
                <th class="input_label">
                  <span data-with-info="#infoOperator">
                    Operator
                  </span>
                </th>
                <td colspan="2" class="widest">
                  <select name="operator" class="operator" data-msg="Must be a trained operator" required>
                    <option></option>
                  </select>
                </td>
              </tr>
              <tr>
                <th class="input_label">
                  <span data-with-info="#infoTemperature">
                    Temperature
                  </span>
                </th>
                <td class="widest">
                  <input type="number" class="integer" name="temperature" data-msg="Must be between 4&deg;C and 40&deg;C" required min="4" max="40" value="20"> &deg;C
                </td>
              </tr>
              <!--
                  <tr>
                    <th class="input_label">
                      <span data-with-info="#infoHumidity">
                        Relative Humidity
                      </span>
                    </th>
                    <td class="widest">
                      <input data-msg="Must be between 0 and 100" name="humidity" type="number" class="integer" min="0" max="100"> %
                    </td>
                  </tr>
                  -->
              <tr>
                <th class="input_label">
                  <span data-with-info="#infoSession">
                    Runtime
                  </span>
                </th>
                <td class="widest">
                  <button class="session_play">
                    <span class="fas fa-play"></span>
                  </button>
                  <button class="session_pause">
                    <span class="fas fa-pause"></span>
                  </button>
                  This session: <span class="session_time">00:00</span>,
                  <span data-with-info="#infoManualHours">Total</span>
                  <input type="floating_point" step="0.01" name="runtime" data-msg="Must be greater than the last recorded runtime" min="0" required> minutes
                </td>
              </tr>
            </table>
            <div style="float:right">
              <label for="portable_filters_changed">Filters changed</label>
              <input data-with-info="#infoFilters" type="checkbox" id="portable_filters_changed" name="filters_changed">
            </div>
          </form>
          <button name="add_record">Touch here to record this run</button>
        </div>
        
        <div id="loans" class="crowded_tab">
          <div>
            <div style="float:right">
              <label for="loan_show_all">Show returned items</label>
              <input type="checkbox" value="false" id="loan_show_all">
            </div>
            <span data-with-info="#infoLoans">Enter new loans on the last row of the table</span>
            <div id="loan_some_late" class="hidden warning">
              One or more returns are <span data-with-info="#infoLate">
                late</span>
            </div>
          </div>
          <div id="loan_controls">
            <button id="loan_save" class="loan_control">
              <span class="ui-icon ui-icon-disk"></span>
              Save Changes
            </button>
            <button id="loan_reset" class="loan_control">
              <span class="ui-icon ui-icon-arrowreturnthick-1-w"></span>
              Discard Changes
            </button>
          </div>
          <div style="clear:both" class="scroll_container">
            <table id="loan_table" class="zebra tablesorter" data-order="date,count,item,borrower,lender,donation,returned">
              <thead>
                <th>Date</th>
                <th class="sorter-false isnumber">#</th>
                <th class="widest">Item</th>
                <th>Borrower</th>
                <th>Lender</th>
                <th class="sorter-false isnumber">&pound;</th>
                <th>Returned&nbsp;to</th>
              </thead>
              <tbody>
              </tbody>
              <tfoot>
                <th class="loan_foot" id="loan_dlg_date"></th>
                <th class="loan_foot" id="loan_dlg_count"></th>
                <th class="loan_foot" id="loan_dlg_item"></th>
                <th class="loan_foot" id="loan_dlg_borrower"></th>
                <th class="loan_foot" id="loan_dlg_lender"></th>
                <th class="loan_foot" id="loan_dlg_donation"></th>
                <th>
                  <button id="loan_add" data-with-info="#infoAddLoan">
                    Add
                  </button>
                </th>
              </tfoot>
            </table>
          </div>
        </div>
        
        <div id="inventory" class="crowded_tab inventory_tab">
          <div>
          </div>
        </div>
        
        <div id="nitrox" class="tab">
          Nitrox calculator. Only to be used by trained nitrox blenders.
          <form>
            <p>
              <label for="nox_t"> Ambient Temperature</label>
              <input id="nox_t" name="temperature" data-msg="Must be between 4&deg;C and 40&deg;C" required type="number" class="integer" min="4" max="40" value="20"> &deg;C
            </p>
            <p>
              <label for="nox_cs">Dive Cylinder size</label>
              <input id="nox_cs" name="cylinder_size" data-msg="Must be between 1 and 30 litres" required type="number" class="integer" min="1" max="30" value="12"> L,
              <label for="nox_sp">Current Pressure</label>
              <input id="nox_sp" name="start_pressure" required type="number" class="integer" min="1" max="232" value="50"> bar,
              <label for="nox_sm">Current Mix</label>
              <input id="nox_sm" name="start_mix" data-msg="Must be between 21% and 100%" required type="number" class="integer" min="21" max="100" value="21">%
            </p>
            <p>
              <label for="nox_tp">Target Pressure</label>
              <input id="nox_tp" name="target_pressure" data-msg="Must be between 0 and 232 bar" required type="number" class="integer" min="1" max="232" value="232"> bar,
              <label for="nox_tm">Target Mix</label>
              <input id="nox_tm" name="target_mix" data-msg="Must be between 21% and 100%" required type="number" class="integer" min="21" max="100" value="32">%
            </p>
            <p>
              <label for="nox_o2s" data-with-info="#infoBankSize">Pure O<sub>2</sub> cylinder size</label>
              <input id="nox_o2s" name="O2_bank_size" data-msg="Must be between 10 and 100" required type="number" class="floating_point" min="10" max="100" step="0.01" value="47.2"> L,
              <label for="nox_o2p">Pressure</label>
              <input id="nox_o2p" name="O2_bank_pressure" data-msg="Must be between 1 and 300" required type="number" class="integer" min="1" max="300" value="200"> bar
            </p>
            <input type="submit" value="Calculate">
          </form>
          <div class="report">
          </div>
        </div>
      </div>
    </div>
    
    <div id="settings_dialog" class="hidden" data-title="<span class='fas fa-sliders-h'></span> Settings">
      <form>
        <table class="form_table zebra">
          <tr>
            <th class="input_label">
              <span data-info="#infoDeadline">
                Loan return deadline
              </span>
            </th>
            <td class="widest">
              <input type="number" required class="integer" name="loan_return"> days
            </td>
          </tr>
          <tr>
            <th class="input_label">
              <span data-info="#infoO2Price">
                O<sub>2</sub> cost per litre &pound;
              </span>
            </th>
            <td class="widest">
              <input type="number" class="floating_point" step="any" required name="o2_price">
            </td>
          </tr>
          <tr>
            <th class="input_label">
              <span data-info="#infoMaxPPO2">
                Max ppO<sub>2</sub>
              </span>
            </th>
            <td class="widest">
              <input type="number" class="floating_point" step="any" required name="ppO2max"> bar
            </td>
          </tr>
          <tr>
            <th class="input_label">
              <span data-info="#infoLifetime">
                Static Compressor
              </span>
            </th>
            <td class="widest">
              Predicted Lifetime:
              <input type="number" class="integer" step="any" required name="static_filter_lifetime"> hours
              <table>
                <tr>
                  <td>Coefficients:</td>
                  <td class="widest">
                    A <input type="number" class="floating_point" step="any" required name="static_filter_coeff_a">
                    B <input type="number" class="floating_point" step="any" required name="static_filter_coeff_b"><br/>
                    C <input type="number" class="floating_point" step="any" required name="static_filter_coeff_c">
                    D <input type="number" class="floating_point" step="any" required name="static_filter_coeff_d">
                  </td>
                </tr>
                <tr>
                  <td>Temperature sensor ID:</td>
                  <td>
                    <input type="text" name="static_filter_sensor_id">
                  </td>
                </tr>
              </table>
            </td>
          </tr>
          <tr>
            <th class="input_label">
              <span data-info="#infoLifetime">
                Portable Compressor
              </span>
            </th>
            <td class="widest">
              Predicted Lifetime:
              <input type="number" class="integer" step="any" required name="portable_filter_lifetime"> hours
              <table>
                <tr>
                  <td>Coefficients:</td>
                  <td class="widest">
                    A <input type="number" class="floating_point" step="any" required name="portable_filter_coeff_a">
                    B <input type="number" class="floating_point" step="any" required name="portable_filter_coeff_b"><br/>
                    C <input type="number" class="floating_point" step="any" required name="portable_filter_coeff_c">
                    D <input type="number" class="floating_point" step="any" required name="portable_filter_coeff_d">
                  </td>
                </tr>
              </table>
            </td>
          </tr>
          <tr>
            <th>
              <span data-info="#infoDB">Databases</span>
            </th>
            <td>
              <table>
                <tr>
                  <td>Online DB (Google Drive) index URL:</td>
                  <td class="widest"><input style="width:100%" type="text" url required name="db_index_url"></td>
                </tr>
                <tr>
                  <td>Store cache (WebDAV) URL:</td>
                  <td class="widest">
                    <input class="widest" type="text" url required name="cache_url">
                  </td>
                </tr>
                <tr>
                  <td>Sample URL:</td>
                  <td class="widest">
                    <input style="width:100%" type="text" url required name="sensor_url">
                  </td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
      </form>
    </div>

    <div id="inventory_pick_dialog" class="hidden">
      <div class="crowded_tab inventory_tab" data-hide-cols="Kit Pool,Location,Count">
      </div>
    </div>

    <div id="auth_required" class="hidden" title="Authentication required">
      Login to <span class="url">?</span>
      <table>
        <tr><td>User:</td>
          <td class="widest"><input class="widest" type='text' name='user'></td>
        </tr><tr><td>Pass:</td>
          <td class="widest"><input class="widest" type='password' name='pass'></td>
      </tr></table>
    </div>
    
    <div id="connect_failed_dialog" class="hidden" title="Connect failed">
      Could not connect to store cache at '<span class="url">?</span>'
      <table>
        <tr>
          <td>Store cache URL:</td>
          <td class="widest"><input class="widest" type="text" name="cache_url"></td>
        </tr>
      </table>
    </div>

    <div id="alert_dialog" class="hidden" title="Alert">
      <div id="alert_body">
      </div>
    </div>

    <!-- Compressor help -->
    <div class="hidden info" id="infoLastRun" data-title="<span class='fas fa-cog'></span> Last Run">
      If you made a mistake, you can remove this record from the compressor
      history.
      <div class="warning">Please be careful, this can't be undone!</div>
    </div>
    <div class="hidden info" id="infoFilterEfficiency">
      <p>Filter lifetime is predicted based on the intake air temperature
        and runtime from the compressor records, and does <em>not</em>
        reflect on the efficiency of the filters.</p>
      <p>When the lifetime drops below 2 hours, email hsac-equipment@gmail.com
        so the filters can be changed (or, better, learn to change them yourself.)</p>
      <p class="warning">
        <strong>NEVER</strong> use the compressor if the filter
        lifetime is negative!
      </p>
    </div>
    <div class="hidden info" id="infoOperator">
      Only trained operators may use this compressor. Please
      select your name from the list. If you are not there and
      want to be trained, contact hsac.training@gmail.com
    </div>
    <div class="hidden info" id="infoTemperature">
      If the electronic thermometer is functioning, the temperature will be
      sensed automatically. Otherwise the temperature must be taken from the
      thermometer on the compressor air intake at the <strong>end</strong>
      of the filling session and entered manually.
    </div>
    <div class="hidden info" id="infoFilters">
      Select this <strong>only</strong> if the filters have just
      been changed. It will reset the filter lifetime clock.
    </div>
    <div class="hidden info" id="infoRuntime">
      Runtime is read from the counter on the right of the
      compressor control panel.
    </div>
    <div class="hidden info" id="infoSession">
      Tap <span class="fas fa-play"></span> when the compressor starts, and <span class="fas fa-pause"></span> if you need to temporarily stop the compressor for longer than a bottle change. When the session is finished, click <span class="fas fa-pause"></span> and then "Touch here to record this run"
    </div>
    <div class="hidden info" id="infoManualHours">
      If you forgot to start the timer, you can manually enter the <b>total</b> compressor run time here. Look at the runtime when the compressor was last run, and add the number of <b>minutes</b> you have run for. Enter the total here and record the run.
    </div>

    <!-- Loans help -->
    <div class="hidden info" id="infoLoans">
      <dl>
        <dt>Date</dt><dd>Touch the date to correct it if necessary</dd>
        <dt>Borrower</dt><dd>
          Select the borrower's name. Only current members of the club
          can borrow equipment. If the borrower's name does not appear
          on this list, select their instructor instead</dd>
        <dt>Lender</dt><dd>Select the lender' name. Only qualified
          compressor operators can lend equipment</dd>
        <dt>Donation</dt><dd>
          All members except those currently on the Ocean Diver course
          are asked to make a donation to the club to help with
          equipment maintenance. See the notices on the wall for the
          current recommended donations</dd>
        <dt>Returned</dt><dd>
          When something is returned to you, select the 'Returned' column for that item and add your name
        </dd>
      </dl>
      You can also edit older loans e.g. to indicate when a loan was
      returned, or correct an error. Just touch the item you want to
      edit, then touch "Save Changes" (or "Discard Changes").
    </div>
    <div class="hidden info" id="infoAddLoan">
      Touch "Add" to record the details you entered on the last row of
      the table.
    </div>
    <div class="hidden info" id="infoLate">
      Members are requested to make an additional donation when
      items are returned late. <strong>This includes trainees</strong>
    </div>

    <!-- Inventory help -->
    <div class="hidden info" id="infoOnLoan1">
      The number in brackets indicates how many are out on loan
    </div>
    <div class="hidden info" id="infoOnLoan2">
      Crossed-out entries are out on loan
    </div>

    <!-- Nitrox help -->
    <div class="hidden info" id="infoBankSize">
      This is the size (in litres) of the O<sub>2</sub> cylinder you want to
      use. A 'J' cylinder is 47.2L, while a 'W' is 45.7L. Check the
      shoulder of the cylinder you are using if you are unsure. Always
      use the leftmost cylinder that has sufficient pressure for the
      fill you want
    </div>
    
    <!-- Settings help -->
    <div class="hidden info" id="infoDeadline">
      Deadline beyond which an additional donation is requested for
      late loan returns
    </div>
    <div class="hidden info" id="infoO2Price">
      Price of one litre of O<sub>2</sub>, based on the replacement cost of the
      O<sub>2</sub> cylinders
    </div>
    <div class="hidden info" id="infoMaxPPO2">
      Maximum ppO<sub>2</sub> used when calculating MOD
    </div>  
    <div class="hidden info" id="infoLifetime">
      Lifetime is the predicted lifetime of a filter that is run at the optimum
      temperature. The coefficients are for the filter temperature degradation curve. See <a href="README.html#compressor" target="_blank">README<a> for more
    </div>
    <div class="hidden info" id="infoDB">
      Two databases are used:
      <ul>
        <li>A read-only online database, accessed through the URL of a CSV file that contains the root index</li>
        <li>A read-write cache server
      </ul>
      Click "Update" to update the cache server from the online database. See <a href="README.html#read-only-database" target="_blank">README<a> for more
      </p>
    </div>
  </body>
</html>
